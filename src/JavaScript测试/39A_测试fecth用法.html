<!DOCTYPE html>
<!-- 
    1、fetch是基于Promise实现的网络处理Api，可以看作是ajax的升级版。主要是为了用Promise来网络调用。
    2、fetch也是通过then方法来接收异步的结果，但是需要用参数调用text()方法来返回Promise对象。
    3、fetch里都是通过方法的参数来请求GET、POST、DELETE、PUT等方法。传入一个json对象。
 -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>测试fecth的用法</title>
</head>
<body>
    <script type="text/javascript">
        /*
          Fetch API 基本用法
        */
        fetch('http://localhost:3000/fdata').then(function(data){
          // text()方法属于fetchAPI的一部分，它返回一个Promise实例对象，用于获取后台返回的数据
          return data.text();
        }).then(function(data){
          //这里才是最终的数据
          console.log(data);
        })

        /*
      Fetch API 调用接口传递参数
    */

    // GET参数传递-传统URL
    fetch('http://localhost:3000/books?id=123', {
      method: 'get'

    }).then(function(data){
      return data.text();

    }).then(function(data){
      console.log(data)

    });

    // GET参数传递-restful形式的URL
    fetch('http://localhost:3000/books/456', {
      method: 'get'
    }).then(function(data){
        return data.text();
    }).then(function(data){
        console.log(data)
    });

    // DELETE请求方式参数传递
    fetch('http://localhost:3000/books/789', {
      method: 'delete'
    }).then(function(data){
      return data.text();
    }).then(function(data){
      console.log(data)
    });

    // POST请求传参
    fetch('http://localhost:3000/books', {
      method: 'post',
      body: 'uname=lisi&pwd=123',
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
      }
    }).then(function(data){
      return data.text();
    }).then(function(data){
      console.log(data)
    });

    // POST请求传参
    fetch('http://localhost:3000/books', {
      method: 'post',
      body: JSON.stringify({
        uname: '张三',
        pwd: '456'
      }),
      headers: {
        'Content-Type': 'application/json'
      }
    })
    .then(function(data){
      return data.text();
    }).then(function(data){
      console.log(data)
    });

    // PUT请求传参
    fetch('http://localhost:3000/books/123', {
      method: 'put',
      body: JSON.stringify({
        uname: '张三',
        pwd: '789'
      }),
      headers: {
        'Content-Type': 'application/json'
      }
    }).then(function(data){
        return data.text();
    }).then(function(data){
      console.log(data)
    });
    </script>   
</body>
</html>