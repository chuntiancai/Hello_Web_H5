<!DOCTYPE html>
<html lang="en">
    <!-- 
        1、p.then()得到异步任务的正确结果。
        2、p.catch()获取异常信息。
        3、p.finally()成功与否都会执行（还不是正式标准）
        4、Promise.all()并发处理多个异步任务，所有任务都执行完成才能得到结果。
        5、Promise.race()并发处理多个异步任务，只要一个任务完成就能得到结果。
     -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>测试Promise对象的方法</title>
</head>
<body>
    <script>
        /**
         * 一、实例方法
         * 1、then()、catch()、finally()
         */ 
        var p = new Promise(function(resolve, reject){
          setTimeout(function(){
            // resolve(123);
            reject('error');
          }, 100);38
        })

        p.then(function(data){  //成功
          console.log(data)
        })
        .catch(function(data){  //失败
          console.log(data)
        })
        .finally(function(){    //都执行
          console.log('finished')
        });

        /**
         * 二、类方法
         * 1、all()、race()
         */ 
        function queryData(num) {
            return new Promise(function(resolve, reject){
                if(num % 2 == 0) {
                  // 处理正常的情况
                  resolve('my任务成功');
                }else{
                  // 处理异常情况
                  reject('my服务器错误');
                }
            });
        }
        var p1 = queryData(Math.random);
        var p2 = queryData(Math.random);
        var p3 = queryData(Math.random);
        Promise.all([p1,p2,p3]).then(function(result){
          console.log('all执行结果' + result)
        })

        Promise.race([p1,p2,p3]).then(function(result){
            console.log('race执行结果：' + result)
        })
        
    </script>    
</body>
</html>